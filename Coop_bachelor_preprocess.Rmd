---
title: "Coop_bachelor"
author: "Julie Svinth Nielsen"
date: "18/10/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(tidyverse)
library(readr)
```

Load in data and pre-process
```{r}

df_ref <- read_delim("Klimaprojekt tal 23.9 - 6.9.csv", 
    ";", escape_double = FALSE, trim_ws = TRUE)

df <- read_delim("Klimaprojekt tal 7.10 - 13.10.csv", 
    ";", escape_double = FALSE, trim_ws = TRUE)
View(df)


### Der skal fjernes tre nuller fra linje 4

### Der skal laves en kolonne, der inddeler dem i varegrupper

# Removing three first rows
df <- df[-c(1, 2, 3), ]

```

Creating ID column and product column
```{r}

df$ID <- seq.int(nrow(df))
df <- df[-c(66),]

df_40 <- filter(df, uge == "Uge 2021-40")

df_40 <- select(df_40, -c(1,6:14))

df_40$prod_cat<- c("j") 
df_40[c(1,10,57,61), 5] <- c("water")
df_40[c(2,46,62), 5] <- c("beats")
df_40[c(4,51), 5] <- c("onion")
df_40[c(3,7,11,13,21,38,47), 5] <- c("cale")
df_40[c(22,32), 5] <- c("squash")
df_40[c(64), 5] <- c("chickpea")
df_40[c(26,34,54), 5] <- c("apples")
df_40[c(18,43,53), 5] <- c("pear")
df_40[c(14), 5] <- c("berries")
df_40[c(23,45,65), 5] <- c("broccoli")
df_40[c(20,63), 5] <- c("spinage")
df_40[c(5,9,24,25,31,41,42,48,49,55), 5] <- c("potato")
df_40[c(4,19,30,33,36,37,50,52), 5] <- c("tomato")
df_40[c(16,35,56,60), 5] <- c("flour")
df_40[c(17,40), 5] <- c("mushrooms")
df_40[c(28,29,39,44), 5] <- c("carrots")
df_40[c(6), 5] <- c("celeriac")
df_40[c(8,15), 5] <- c("leek")
df_40[c(12), 5] <- c("bread")
df_40[c(27), 5] <- c("plums")
df_40[c(58,59), 5] <- c("corn")


df_ref$ID <- seq.int(nrow(df_ref))

# Create df with week 41
df_41 <- filter(df, uge == "Uge 2021-41")

df_41 <- select(df_41, -c(1,6:14))


df_41$prod_cat<- c("j") 
df_41[c(1,10,57,61), 5] <- c("water")
df_41[c(2,46,62), 5] <- c("beats")
df_41[c(4,51), 5] <- c("onion")
df_41[c(3,7,11,13,21,38,47), 5] <- c("cale")
df_41[c(22,32), 5] <- c("squash")
df_41[c(64), 5] <- c("chickpea")
df_41[c(26,34,54), 5] <- c("apples")
df_41[c(18,43,53), 5] <- c("pear")
df_41[c(14), 5] <- c("berries")
df_41[c(23,45,65), 5] <- c("broccoli")
df_41[c(20,63), 5] <- c("spinage")
df_41[c(5,9,24,25,31,41,42,48,49,55), 5] <- c("potato")
df_41[c(4,19,30,33,36,37,50,52), 5] <- c("tomato")
df_41[c(16,35,56,60), 5] <- c("flour")
df_41[c(17,40), 5] <- c("mushrooms")
df_41[c(28,29,39,44), 5] <- c("carrots")
df_41[c(6), 5] <- c("celeriac")
df_41[c(8,15), 5] <- c("leek")
df_41[c(12), 5] <- c("bread")
df_41[c(27), 5] <- c("plums")
df_41[c(58,59), 5] <- c("corn")


write.csv(x=df_40, file="df_40.csv")
write.csv(x=df_41, file="df_41.csv")

```

## Reference week

```{r}

df_ref <- df_ref[-c(1, 2, 3),]

df_ref <- df_ref[-c(65),]
df_ref <- df_ref[-c(130),]
df_ref$prod_cat<- c("j") 
df_ref <- select(df_ref, -c(1,6:14))


df_38_ref <- filter(df_ref, uge == "Uge 2021-38")
df_39_ref <- filter(df_ref, uge == "Uge 2021-39")
df_40_ref <- filter(df_ref, uge == "Uge 2021-40")


df_38_ref[c(1,10, 56, 60), 5] <- c("water")
df_38_ref[c(2, 45, 61), 5] <- c("beats")
df_38_ref[c(4,50), 5] <- c("onion")
df_38_ref[c(3,7,11,13,21, 37, 46), 5] <- c("cale")
df_38_ref[c(22, 31), 5] <- c("squash")
df_38_ref[c(63), 5] <- c("chickpea")
df_38_ref[c(26, 33, 53), 5] <- c("apples")
df_38_ref[c(18, 42, 52), 5] <- c("pear")
df_38_ref[c(14), 5] <- c("berries")
df_38_ref[c(23, 44, 64), 5] <- c("broccoli")
df_38_ref[c(20, 62), 5] <- c("spinage")
df_38_ref[c(5,9,24,25,30, 40, 41, 47, 48, 54), 5] <- c("potato")
df_38_ref[c(4,19,29, 32, 35, 36, 49, 51), 5] <- c("tomato")
df_38_ref[c(16, 34, 55, 59), 5] <- c("flour")
df_38_ref[c(17, 39), 5] <- c("mushrooms")
df_38_ref[c(28, 38, 43), 5] <- c("carrots")
df_38_ref[c(6), 5] <- c("celeriac")
df_38_ref[c(8,15), 5] <- c("leek")
df_38_ref[c(12), 5] <- c("bread")
df_38_ref[c(27), 5] <- c("plums")
df_38_ref[c(57, 58), 5] <- c("corn")

write.csv(x=df_38_ref, file="df_38_ref.csv")


df_39_ref[c(1,10, 57, 61), 5] <- c("water")
df_39_ref[c(2, 46, 62), 5] <- c("beats")
df_39_ref[c(4, 51), 5] <- c("onion")
df_39_ref[c(3,7,11,13,21, 38, 47), 5] <- c("cale")
df_39_ref[c(22, 32), 5] <- c("squash")
df_39_ref[c(64), 5] <- c("chickpea")
df_39_ref[c(26, 34, 54), 5] <- c("apples")
df_39_ref[c(18, 43, 53), 5] <- c("pear")
df_39_ref[c(14), 5] <- c("berries")
df_39_ref[c(23, 45, 65), 5] <- c("broccoli")
df_39_ref[c(20, 63), 5] <- c("spinage")
df_39_ref[c(5,9,24,25, 31, 41, 42, 48, 49, 55), 5] <- c("potato")
df_39_ref[c(4,19, 30, 33, 36, 37, 50, 52), 5] <- c("tomato")
df_39_ref[c(16, 35, 56, 60), 5] <- c("flour")
df_39_ref[c(17, 40), 5] <- c("mushrooms")
df_39_ref[c(28, 29, 39, 44), 5] <- c("carrots")
df_39_ref[c(6), 5] <- c("celeriac")
df_39_ref[c(8,15), 5] <- c("leek")
df_39_ref[c(12), 5] <- c("bread")
df_39_ref[c(27), 5] <- c("plums")
df_39_ref[c(58, 59), 5] <- c("corn")

write.csv(x=df_39_ref, file="df_39_ref.csv")



df_40_ref[c(1,10, 55, 59), 5] <- c("water")
df_40_ref[c(2, 44, 60), 5] <- c("beats")
df_40_ref[c(4, 49), 5] <- c("onion")
df_40_ref[c(3,7,11,13,21, 36, 45), 5] <- c("cale")
df_40_ref[c(22, 31), 5] <- c("squash")
df_40_ref[c(62), 5] <- c("chickpea")
df_40_ref[c(26, 52), 5] <- c("apples")
df_40_ref[c(18, 41, 51), 5] <- c("pear")
df_40_ref[c(14), 5] <- c("berries")
df_40_ref[c(23,43, 63), 5] <- c("broccoli")
df_40_ref[c(20,61), 5] <- c("spinage")
df_40_ref[c(5,9,24,25,30, 39, 40, 46, 47, 53), 5] <- c("potato")
df_40_ref[c(4,19,29, 32, 34, 35, 48, 50), 5] <- c("tomato")
df_40_ref[c(16,33, 54, 58), 5] <- c("flour")
df_40_ref[c(17, 38), 5] <- c("mushrooms")
df_40_ref[c(28,37, 42), 5] <- c("carrots")
df_40_ref[c(6), 5] <- c("celeriac")
df_40_ref[c(8,15), 5] <- c("leek")
df_40_ref[c(12), 5] <- c("bread")
df_40_ref[c(27), 5] <- c("plums")
df_40_ref[c(56, 57), 5] <- c("corn")

write.csv(x=df_40_ref, file="df_40_ref.csv")


```

